import duckdb
import pyarrow.parquet as pq

# Path to your Parquet file
parquet_file = '/Users/jpetrides/Documents/Demo Data/Hotels/hotel_reservations.parquet'

# Path for the new DuckDB file
duckdb_file = '/Users/jpetrides/Documents/Demo Data/Hotels/Jeeves Idea/hotel_reservations.duckdb'

# Connect to a new DuckDB database
con = duckdb.connect(duckdb_file)

# Read the Parquet file and create a table in DuckDB
con.execute(f"CREATE TABLE my_table AS SELECT * FROM read_parquet('{parquet_file}')")

# Commit changes and close the connection
con.commit()
con.close()

print(f"Parquet file has been converted to DuckDB file: {duckdb_file}")


#add the calendar table
